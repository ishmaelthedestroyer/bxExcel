<!doctype html>

<head>
    <title>SpreadJS - RangeGroup</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="description" content="%description%"/>
    <meta name="keywords" content=""/>

    <link rel="stylesheet" href="../../css/gcfilter-ui.css"/>

    <link href="../../css/cobalt/jquery-wijmo.css" rel="stylesheet" type="text/css" title="rocket-jqueryui"/>
    <link href="../../css/jquery.wijmo.wijsuperpanel.css" rel="stylesheet" type="text/css"/>

    <script src="../../scripts/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script src="../../scripts/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="../../scripts/jquery.wijmo.wijspread.full.min.js"></script>

    <script id="scriptInit" type="text/javascript">
    $(document).ready(function () {
        $("#ss").wijspread({sheetCount:1});

        var spread = $("#ss").wijspread("spread");
        spread.useWijmoTheme = true;
        var sheet = spread.getActiveSheet();
        sheet.isPaintSuspended(true);

        sheet.setColumnCount( 7);
        sheet.setRowCount( 34);
        sheet.setColumnWidth(0, 80);
        sheet.setColumnWidth(1, 80);
        sheet.setColumnWidth(2, 110);
        sheet.addSelection(0, 0, 1, 1);
        // set value
        var data =
        [
            ["= Eastern ==========", "", "", 0, 0, "", 0],
            ["Eastern", "Atlantic", "Celtics", 57, 19, "-", 0.750],
            ["Eastern", "Atlantic", "76ers", 38, 35, 17.5, 0.521],
            ["Eastern", "Atlantic", "Nets", 31, 44, 25.5, 0.413],
            ["Eastern", "Atlantic", "Raptors", 29, 45, 27, 0.392],
            ["Eastern", "Atlantic", "Knicks", 29, 46, 27.5, 0.387],
            ["Eastern", "Central", "Cavaliers", 61, 13, "-", 0.824],
            ["Eastern", "Central", "Pistons", 36, 39, 25.5, 0.480],
            ["Eastern", "Central", "Bulls", 36, 40, 26, 0.474],
            ["Eastern", "Central", "Pacers", 32, 43, 29.5, 0.427],
            ["Eastern", "Central", "Bucks", 32, 44, 30, 0.421],
            ["Eastern", "Southeast", "Magic", 55, 19, "-", 0.743],
            ["Eastern", "Southeast", "Hawks", 43, 32, 12.5, 0.573],
            ["Eastern", "Southeast", "Heat", 39, 36, 16.5, 0.520],
            ["Eastern", "Southeast", "Bobcats", 34, 41, 21.5, 0.453],
            ["Eastern", "Southeast", "Wizards", 17, 59, 39, 0.224],
            ["= Total ==========", "", "", 0, 0, "", 0],
            ["= Western ==========", "", "", 0, 0, "", 0],
            ["Western", "Northwest", "Nuggets", 49, 26, "-", 0.653],
            ["Western", "Northwest", "Trail Blazers", 47, 27, 1.5, 0.635],
            ["Western", "Northwest", "Jazz", 46, 28, 2.5, 0.622],
            ["Western", "Northwest", "Thunder", 21, 53, 27.5, 0.284],
            ["Western", "Northwest", "Timberwolves", 21, 54, 28, 0.280],
            ["Western", "Pacific", "Lakers", 59, 16, "-", 0.787],
            ["Western", "Pacific", "Suns", 41, 34, 18, 0.547],
            ["Western", "Pacific", "Warriors", 26, 49, 33, 0.347],
            ["Western", "Pacific", "Clippers", 18, 57, 41, 0.240],
            ["Western", "Pacific", "Kings", 16, 58, 42.5, 0.216],
            ["Western", "Southwest", "Spurs", 48, 29, "-", 0.649],
            ["Western", "Southwest", "Rockets", 48, 27, 0.5, 0.640],
            ["Western", "Southwest", "Hornets", 47, 27, 1, 0.635],
            ["Western", "Southwest", "Mavericks", 45, 30, 3.5, 0.600],
            ["Western", "Southwest", "Grizzlies", 20, 54, 28, 0.270],
            ["= Total ==========", "", "", 0, 0, "", 0]
        ];

        for (var r = 0; r < data.length; r++)
        {
            var dc = data[r];
            for (var c = 0; c < dc.length; c++)
            {
                sheet.setValue(r, c, dc[c]);
            }
        }

        sheet.addSpan(0, 0, 1, 7);
        sheet.addSpan(16, 0, 1, 3);
        sheet.addSpan(17, 0, 1, 7);
        sheet.addSpan(33, 0, 1, 3);
        sheet.setRowCount(2, $.wijmo.wijspread.SheetArea.colHeader);
        sheet.colHeaderAutoTextIndex = 1;
        sheet.getCell(0, 0, $.wijmo.wijspread.SheetArea.colHeader).value( "2008-09 NBA Regular Season Standings");
        sheet.addSpan(0,0, 1, 7,  $.wijmo.wijspread.SheetArea.colHeader);
        sheet.getCell(0, 0, $.wijmo.wijspread.SheetArea.colHeader).font("14px Arial, sans-serif");
        sheet.getCell(0, 0, $.wijmo.wijspread.SheetArea.colHeader).hAlign( $.wijmo.wijspread.HorizontalAlign.center);
        sheet.getCell(0, 0, $.wijmo.wijspread.SheetArea.colHeader).vAlign( $.wijmo.wijspread.VerticalAlign.center);
        sheet.getCell(0, 0, $.wijmo.wijspread.SheetArea.colHeader).foreColor("Gray");
        sheet.setRowHeight(0, 30, $.wijmo.wijspread.SheetArea.colHeader);

        sheet.getColumn(2).foreColor("Blue");
        sheet.getCell(19, 2).foreColor("Blue");
        sheet.setValue(1, 0, "Conference", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 1, "Standing", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 2, "Team", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 3, "W", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 4, "L", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 5, "GB", $.wijmo.wijspread.SheetArea.colHeader);
        sheet.setValue(1, 6, "PCT", $.wijmo.wijspread.SheetArea.colHeader);

        // set row range group
        sheet.rowRangeGroup.group(1, 15); // eastern
        sheet.rowRangeGroup.group(1, 4);
        sheet.rowRangeGroup.group(6, 4);
        sheet.rowRangeGroup.group(11, 4);
        sheet.rowRangeGroup.group(18, 15); // western
        sheet.rowRangeGroup.group(18, 4);
        sheet.rowRangeGroup.group(23, 4);
        sheet.rowRangeGroup.group(28, 4);

        sheet.isPaintSuspended(false);

    });

    function btnGroup_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();
        try
        {
            var selections = sheet.getSelections();
            if(selections && selections.length > 0) {
                var cr = selections[0];
                if (cr.col == -1 && cr.row == -1){ // sheet selection
                }
                else if (cr.col == -1) {// row selection
                    sheet.rowRangeGroup.group(cr.row, cr.rowCount);
                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else if (cr.row == -1) {// column selection
                    sheet.colRangeGroup.group(cr.col, cr.colCount);
                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else {// cell range selection
                    alert("Please select row or column for group");
                }
            }
        } catch(ex) {
            alert(ex.message);
        }
    };

    function btnUngroup_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();

        try
        {
            var selections = sheet.getSelections();
            if(selections && selections.length > 0) {
                var cr = selections[0];
                if (cr.col == -1 && cr.row == -1){ // sheet selection
                }
                else if (cr.col == -1) {// row selection
                    sheet.rowRangeGroup.ungroupRange(cr.row, cr.rowCount);
                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else if (cr.row == -1) {// column selection
                    sheet.colRangeGroup.ungroupRange(cr.col, cr.colCount);
                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else {// cell range selection
                    alert("Please select row or column for group");
                }
            }
        } catch(ex) {
            alert(ex.message);
        }
    };

    function btnShowDetail_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();

        try
        {
            var selections = sheet.getSelections();
            if(selections && selections.length > 0) {
                var cr = selections[0];
                if (cr.col == -1 && cr.row == -1){ // sheet selection
                }
                else if (cr.col == -1) {// row selection
                    for (var i = 0; i < cr.rowCount; i++) {
                        var rgi = sheet.rowRangeGroup.find(i + cr.row, 0);
                        if (rgi != null)
                        {
                            sheet.rowRangeGroup.expandGroup(rgi, true);
                        }
                    }

                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else if (cr.row == -1) {// column selection
                    for (var i = 0; i < cr.colCount; i++) {
                        var rgi = sheet.colRangeGroup.find(i + cr.col, 0);
                        if (rgi != null) {
                            sheet.colRangeGroup.expandGroup(rgi, true);
                        }
                    }

                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else {// cell range selection
                    alert("Please select row or column for group");
                }
            }
        } catch(ex) {
            alert(ex.message);
        }
    };

    function btnHideDetail_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();

        try
        {
            var selections = sheet.getSelections();
            if(selections && selections.length > 0) {
                var cr = selections[0];
                if (cr.col == -1 && cr.row == -1){ // sheet selection
                }
                else if (cr.col == -1) {// row selection
                    for (var i = 0; i < cr.rowCount; i++) {
                        var rgi = sheet.rowRangeGroup.find(i + cr.row, 0);
                        if (rgi != null)
                        {
                            sheet.rowRangeGroup.expandGroup(rgi, false);
                        }
                    }

                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else if (cr.row == -1) {// column selection
                    for (var i = 0; i < cr.colCount; i++) {
                        var rgi = sheet.colRangeGroup.find(i + cr.col, 0);
                        if (rgi != null) {
                            sheet.colRangeGroup.expandGroup(rgi, false);
                        }
                    }

                    sheet.invalidateLayout();
                    sheet.repaint();
                }
                else {// cell range selection
                    alert("Please select row or column for group");
                }
            }
        } catch(ex) {
            alert(ex.message);
        }
    };

    function ckbRowSummary_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();

        var checked = $("#row_summary").prop("checked");
        if(checked) {
            sheet.rowRangeGroup.direction = $.wijmo.wijspread.RangeGroupDirection.Forward;
        } else {
            sheet.rowRangeGroup.direction = $.wijmo.wijspread.RangeGroupDirection.Backward;
        }

        sheet.invalidateLayout();
        sheet.repaint();
    };

    function ckbColSummary_Click(event) {
        var spread = $("#ss").wijspread("spread");
        var sheet = spread.getActiveSheet();

        var checked = $("#col_summary").prop("checked");
        if(checked){
            sheet.colRangeGroup.direction = $.wijmo.wijspread.RangeGroupDirection.Forward;
        } else {
            sheet.colRangeGroup.direction = $.wijmo.wijspread.RangeGroupDirection.Backward;
        }
        sheet.invalidateLayout();
        sheet.repaint();
    };
    </script>

</head>
<body class="demo-single">
<div class="container">
    <div class="header">
        <h2>SpreadJS RangeGroup</h2>
    </div>
    <div class="main demo">
        <div id="ss" style="width:100%; height:400px;border: 1px solid gray; "></div>

        <div class="demo-options">
            <div class="option-row">
                <input type="button" value="Group" onclick="btnGroup_Click(event)"/>
                <input type="button" value="Ungroup" onclick="btnUngroup_Click(event)"/>
                <input type="button" value="Show Detail" onclick="btnShowDetail_Click(event)"/>
                <input type="button" value="Hide Detail" onclick="btnHideDetail_Click(event)"/>
            </div>
            <div class="option-row">
                <input type="checkbox" id="row_summary" checked onclick="ckbRowSummary_Click(event)"/>
                <label for="row_summary">Summary Rows Below Details</label>
                <input type="checkbox" id="col_summary" checked onclick="ckbColSummary_Click(event)"/>
                <label for="col_summary">Summary Columns Right Detail</label>
            </div>
        </div>
    </div>

    <div class="footer demo-description">
        <p>
            Ties a range of cells (both rows and columns) together so that they can be collapsed or expanded.
        </p>
    </div>
</div>
</body>
</html>